USE LAB_DB;
USE WAREHOUSE LAB_WH;

SELECT ORDER_ID, SUM (QUANTITY * UNIT_PRICE) "ORDER TOTAL"
FROM ORDER_DETAILS    
    GROUP BY ORDER_ID
   ORDER BY "ORDER TOTAL" DESC;
   
   
SELECT ORDER_ID, SUM (QUANTITY * UNIT_PRICE) "ORDER TOTAL"
     ,RANK() OVER (ORDER BY "ORDER TOTAL" DESC) AS ORDER_TOTAL_RANK
    FROM ORDER_DETAILS  
    GROUP BY ORDER_ID;   


SELECT ORDER_ID, SUM (QUANTITY * UNIT_PRICE) "ORDER TOTAL"
     ,ROW_NUMBER() OVER (ORDER BY "ORDER TOTAL" DESC) AS ROW_NUM
    FROM ORDER_DETAILS  
    GROUP BY ORDER_ID;
    
ALTER WAREHOUSE LAB_WH SUSPEND;    

   
