
-- Quering data



-- TYPES of COMMENTS:
/* this is a multi-line
a comment */ 

-- A single line comment

// This comment works too

// ---------------------
⁯USE WAREHOUSE LAB_WH; ⁯
USE DATABASE LAB_DB; 

SELECT ORDER_ID, SUM (QUANTITY * UNIT_PRICE) "ORDER TOTAL"
FROM ORDER_DETAILS    
    GROUP BY ORDER_ID;


    
SELECT O.ORDER_ID, OD.INVENTORY_ID, OD.STATUS_ID, O.EMPLOYEE_ID
    FROM  ORDER_DETAILS OD JOIN  ORDERS O
    ON OD.ORDER_ID = O.ORDER_ID
    ORDER BY O.ORDER_DATE;
    


SELECT ORDER_ID, SUM (QUANTITY * UNIT_PRICE) "ORDER TOTAL"
FROM ORDER_DETAILS    
    GROUP BY ORDER_ID
    OFFSET 0 FETCH 5;
    
    
    
SELECT ORDER_ID, SUM (QUANTITY * UNIT_PRICE) "ORDER TOTAL"
FROM ORDER_DETAILS    
    GROUP BY ORDER_ID
    OFFSET 5 FETCH 5;    
    
-- VIEWS
 
CREATE OR REPLACE VIEW V_INVOICED_ORDERS
AS
SELECT O.ORDER_ID, OD.INVENTORY_ID, O.EMPLOYEE_ID
    FROM  ORDER_DETAILS OD JOIN  ORDERS O
    ON OD.ORDER_ID = O.ORDER_ID WHERE OD.STATUS_ID = 'Invoiced'
    ORDER BY O.ORDER_DATE   


SELECT * FROM V_INVOICED_ORDERS WHERE EMPLOYEE_ID = 9;

Get the Query ID from UI, and drill down 
Check the query profile 

// Use it in The Snowsight Experience; drill down on dates
// DATEBUCKET FILTER
SELECT ORDER_ID, CUSTOMER_ID, SHIP_ADDRESS, max(SHIPPING_FEE) 
FROM   ORDERS 
GROUP  BY :datebucket(ORDER_DATE)


